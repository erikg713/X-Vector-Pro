"""
Port Scanner Exploit

Description:
Scans a target IP address for open TCP ports using sockets.
Useful for recon, fingerprinting, and service enumeration.

Author: X-Vector Pro Toolkit
"""

import argparse
import socket
from concurrent.futures import ThreadPoolExecutor

COMMON_PORTS = {
    21: "FTP",
    22: "SSH",
    23: "Telnet",
    25: "SMTP",
    53: "DNS",
    80: "HTTP",
    110: "POP3",
    143: "IMAP",
    443: "HTTPS",
    3306: "MySQL",
    3389: "RDP"
}

def scan_port(ip, port, timeout=1):
    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as sock:
        sock.settimeout(timeout)
        try:
            sock.connect((ip, port))
            service = COMMON_PORTS.get(port, "Unknown")
            print(f"[OPEN] Port {port} ({service})")
        except:
            pass  # Closed or filtered

def run_scan(target_ip, port_range):
    print(f"[+] Scanning target: {target_ip}")
    print(f"[+] Port range: {port_range[0]} - {port_range[1]}")

    with ThreadPoolExecutor(max_workers=100) as executor:
        for port in range(port_range[0], port_range[1] + 1):
            executor.submit(scan_port, target_ip, port)

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="TCP Port Scanner")
    parser.add_argument("--target", required=True, help="Target IP address")
    parser.add_argument("--start-port", type=int, default=1, help="Start of port range (default: 1)")
    parser.add_argument("--end-port", type=int, default=1024, help="End of port range (default: 1024)")
    args = parser.parse_args()

    print("=== Ethical Use Notice ===")
    print("Only scan systems you are authorized to test.")
    print("==========================")

    run_scan(args.target, (args.start_port, args.end_port))
