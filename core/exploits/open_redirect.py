import requests

tags = ["web", "redirect"]

def run(target):
    payload_url = f"http://{target}/?url=http://evil.com"
    try:
        resp = requests.get(payload_url, allow_redirects=False, timeout=5)
        if "evil.com" in resp.headers.get("Location", ""):
            return f"Open redirect confirmed: {payload_url}"
        return "No open redirect found."
    except Exception as e:
        raise RuntimeError(f"Error testing redirect: {e}")
