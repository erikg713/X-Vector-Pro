import requests

tags = ["cms", "joomla", "leak"]

def run(target):
    url = f"http://{target}/configuration.php"
    try:
        resp = requests.get(url, timeout=5)
        if "class JConfig" in resp.text:
            return f"[+] Joomla config leak: {url}\nExtract:\n{resp.text[:200]}"
        return "[-] No Joomla config exposure detected."
    except Exception as e:
        raise RuntimeError(f"Request error: {e}")
